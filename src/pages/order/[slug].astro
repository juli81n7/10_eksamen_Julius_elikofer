---
import Footer from "../../components/Footer.astro";
import Header from "../../components/Header.astro";
import Form_2 from "../../components/Form_2.astro";
import Knap from "../../components/Knap.astro";
import "../../styles/style.css";

export async function getStaticPaths() {
    const url = "https://fttrpxvnwfswdwvtcifh.supabase.co/rest/v1/stock";

    const options = {
        headers: {
            apikey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ0dHJweHZud2Zzd2R3dnRjaWZoIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODQzOTgwMzcsImV4cCI6MTk5OTk3NDAzN30.jiQY1R9_4xH6PJgdeCvhKQKRA6bfCLB2ciJOBVzotc4",
        },
    };

    const respons = await fetch(url, options);
    const data = await respons.json();

    return data.map((item) => ({
        params: { slug: item.slug },
        props: { item },
    }));
}

const { item } = Astro.props;
---

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <link rel="icon" type="image/svg+xml" href="/svg/favicon.svg" />
        <meta name="viewport" content="width=device-width" />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet" />
        <meta name="generator" content={Astro.generator} />
        <meta name="description" content="Side hvor man kan se at man har gennemført sin ordre" />
        <title>Cehofski - Order complete</title>
    </head>

    <body>
        <Header />
        <main>
            <div class="container">
                <section>
                    <div class="item">

                            <div class="img_container">
                                <img src={"../../img/" + item.img2 + ".webp"} alt="" />

                        </div>
                        <div class="main_info">
                            <div class="info">
                                {/* Betinget rendering baseret på værdien af second_name */}
                                {item.second_name ? <h3>{item.name + " " + item.second_name}</h3> : <h3>{item.name}</h3>}
                                <div class="size">
                                    <p class="header">Size</p>
                                    <p>{item.size}</p>
                                </div>

                                {
                                    item.materiale && (
                                        <div class="text">
                                            <p class="header">Materials</p>
                                            <p>{item.materiale}</p>
                                        </div>
                                    )
                                }
                                {
                                    item.sten && (
                                        <div class="text">
                                            <p class="header">Stone</p>
                                            <p>{item.sten}</p>
                                        </div>
                                    )
                                }
                                {
                                    item.text && (
                                        <div class="text">
                                            <p class="header">Description</p>
                                            <p>{item.text}</p>
                                        </div>
                                    )
                                }
                            </div>
                            <div class="price">
                                <h3>{item.price + " DKK"}</h3>
                            </div>
                        </div>
                    </div>
                    <div class="order">
                        <h2>Order</h2>
                        <p>
                            Please note, that your order is only seen as a reservation. <br /> When you've completed the form, you have reserved the item, and we will reach out to you after that, to sort
                            out payment and shipping or collecting.
                        </p>
                        <Form_2 slug={item.slug} />
                    <p>
                        Note that your reservation lasts 14 days, if the purchase is not completed within those 14 days, others will be able to buy the
                        item
                    </p>
                    </div>
                </section>
            </div>
        </main>

        <Footer />
    </body>
    <style>
        main {
            align-items: center;
            overflow: hidden;
        }

        .item {
            border: 1px solid var(--black);
            display:grid;

            width:100%
     
        }
        main p {
            max-width: 70ch;
        }
        .img_container {
            height:100%;
            width:100%;

            overflow: hidden;
            display: flex;
            justify-content: center;

            border-bottom: 1px solid var(--black);
        }
        img {

            object-fit: cover;
            align-self: stretch;
            max-height: 1000px;
            width:100%;
        }
        section {
            display: flex;
            justify-content: center;
            align-items:center
            height: 100%;
        }
        .order {
            padding: 3rem;
            border: 1px solid var(--black);
            border-left:none;
        }

        .main_info {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }
        h3 {
            margin-bottom: -0.5rem;
            color: var(--black);
            font-size:2.5rem;
        }
        h2 {
            line-height: 1;
        }
        .info {
            margin-left: 1rem;
            margin-top: 1rem;
            margin-bottom: 1rem;
        }
        .info p {
            padding-right: 3rem;
            max-width: 35ch;
        }
        .text {
            justify-content: space-between;
            padding: 0.4rem 0rem 0.4rem 0rem;
            width: 100%;
        }
        .header {
            font-weight: 900;
            font-size: 1rem;
        }

        .size {
            justify-content: space-between;
            padding: 0.4rem 0rem 0.4rem 0rem;
            width: 100%;
        }
        .price {
            align-self: end;
            text-align: right;
            border-bottom: 1px solid var(--black);
            padding-bottom: 0.1rem;
            margin-bottom: 1rem;
            margin-right: 1rem;
            margin-left: 1rem;
        }
        h1 {
            line-height: 8rem;
            margin-bottom: -1rem;
        }


  @media (max-width: 800px) {
 section{
    flex-direction:column;
    margin:1rem;
    gap:1rem;
 }
 .order {
            padding: 0rem;
            border: none;
            border-left:none;

        }
        .info p {
     
      max-width: 18ch;
    }

    h3 {
         
            font-size:2rem;
        }
  }


    </style>
</html>
